# 🟢 AGENT CONSTITUTION (핵심 3가지)

> **SYSTEM**: 이 규칙은 모든 AI 에이전트가 따라야 하는 **절대 규칙**입니다.

---

# 무조건 지켜야 하는 최중요 규칙

- 사용자의 말을 너무 과대 해석하거나 임의로 편하게 해석 해서 임의로 코드를 작성하거나 작업을 진행하지 않는다
- 사용자가 말한것, 시키는 작업을 반드시 먼저 설명을 하고 승인후에 작업을 시작한다
- 사용자의 명령이 애매하거나 모호하면 반드시 사용자에게 다시 질문과 설명을 하고 승인을 받아야 한다


## 🚨 규칙 1: 세션 시작 시 (Warmup)

> [!IMPORTANT]
> **새 세션이 열리면 가장 먼저 `.agent/workflows/warmup.md`를 실행하여 기억을 되살리시오.**
> 코드와 문서를 읽지 않고 작업을 시작하는 것은 금지됩니다.

---

## 🚨 규칙 2: task_boundary 호출 시 (작업 시작)

> [!CAUTION]
> **새로운 TaskName 시작 시 이 순서 절대 엄수!**
> **이 순서를 지키지 않으면 모든 작업이 무효 처리됨!**

### 필수 순서 (체크리스트)

```
- [ ] 1. task_boundary() 호출
- [ ] 2. **즉시** npm run start-task -- <type> "제목" 실행
- [ ] 3. 이슈 번호 (#N) 받음
- [ ] 4. task.md에 이슈 번호 기록
- [ ] 5. 작업 시작
```

> [!WARNING]
> **AI 필수 동작**: task_boundary 호출 후 **다음 tool call에서 반드시 start-task 실행**!

### Implementation Plan 작성 규칙 (선조치 금지)

**코드 작성 전 계획 단계에서 이슈 번호 필수!**

```markdown
# Implementation Plan
> **관련 이슈**: #35 (필수 기재!)
```

**규칙**:

1. `implementation_plan.md` 최상단에 관련 이슈 번호 명시
2. **[중요]** 승인 요청 전, **반드시 GitHub 이슈 본문을 상세하게(고등학생 교육용 수준) 업데이트**해야 함.
3. 이슈 생성 및 상세 업데이트 없이는 계획서 승인 불가.

---

## 규칙 3: 체크포인트 및 핸드오버

| 스텝 | 액션 | 필수 여부 |
|:---:|:---|:---:|
| **250** | `docs/HANDOVER.md` 업데이트 (경고) | ✅ |
| **350** | 작업 중단 + 핸드오버 완료 (강제) | ✅ |

**HANDOVER.md 작성 방식**: **스냅샷 + 아카이브** (덮어쓰기 허용)

1. 기존 `docs/HANDOVER.md`를 `docs/history/`로 백업.
2. `docs/HANDOVER.md`를 **백지 상태에서 새로 작성** (템플릿 준수).
3. **아키텍처 및 핵심 맥락** 섹션을 충실히 작성할 것.

---

## 규칙 4: 이슈 작성 규칙 (상세화)

> [!IMPORTANT]
> **개발을 처음 배우는 고등학생도 이해할 수 있도록 상세하고 친절하게 작성해야 함.**

### 필수 포함 항목 (자동 검증됨)

```markdown
## 🎓 배경 지식 (Context)
> "로그인이란 사용자를 식별하는 과정입니다..." (친절한 설명)

## 🎯 목표 (Goal)
> "메인 페이지의 로그인 버튼을 활성화합니다."

## 🛠️ 기술적 계획 (Implementation)
> - `src/Login.js`: 유효성 검사 로직 추가

## ✅ 완료 조건 (Done)
- [ ] 테스트 통과
```

---

## 규칙 5: GitHub 이슈 관리 (Anti-Deadlock)

> [!CAUTION]
> **gh 명령 직접 사용 금지!**

### 문제: 터미널 먹통

`gh issue create` 등을 터미널에서 직접 실행하면 `command_status`가 응답하지 않는 문제 발생.

### 해결: Node.js 스크립트 사용

**항상 프로젝트에 정의된 스크립트를 사용할 것.**

- `npm run start-task` (이슈 생성)
- `npm run finish` (작업 완료 및 커밋)
- `npm run sync-issues` (이슈 동기화)

---

## ⚡ 빠른 참조

| 상황 | 명령 |
|:---|:---|
| **새 작업 시작** | `npm run start-task -- <type> "제목"` |
| **작업 완료** | `npm run finish -- "메시지 (#N)"` |
| **핸드오버** | `/handover` 또는 스텝 250/350 |
| **이슈 동기화** | `npm run sync-issues` |

---

## 규칙 6: Node.js 문법 규칙 (ES Module)

> [!CAUTION]
> **이 프로젝트는 `type: module`입니다.**
>
> - `require(...)` 사용 금지 ❌
> - `import ... from ...` 사용 필수 ✅
> - 파일 확장자는 `.js` 사용 ( `.cjs`는 임시방편임)

---

> **SYSTEM MESSAGE**: 규칙 위반 시 `process.exit(1)`.
