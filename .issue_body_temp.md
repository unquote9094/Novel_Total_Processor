## ğŸ“ ë°°ê²½ ì§€ì‹ (Context)

Stage 2ëŠ” íŒŒì¼ì˜ ì‹¤ì œ ë‚´ìš©ì„ ìƒ˜í”Œë§í•˜ì—¬ í™”ìˆ˜ í‘œê¸° íŒ¨í„´ì„ ë¶„ì„í•˜ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤. íŒŒì¼ëª…ì— í‘œê¸°ëœ í™”ìˆ˜ì™€ ì‹¤ì œ ë‚´ìš©ì˜ í™”ìˆ˜ê°€ ë‹¤ë¥¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, AIë¡œ ì •í™•í•œ í™”ìˆ˜ ë²”ìœ„ë¥¼ ê°ì§€í•©ë‹ˆë‹¤.

## ğŸ¯ ëª©í‘œ (Goal)

1. íŒŒì¼ ìƒ˜í”ŒëŸ¬ êµ¬í˜„ (ì•ë’¤ 20KB ì¶”ì¶œ)
2. chardet ê¸°ë°˜ ì¸ì½”ë”© ìë™ ê°ì§€
3. AI ê¸°ë°˜ í™”ìˆ˜ íŒ¨í„´ ê°ì§€ (ì •ê·œì‹ ì¶”ì¶œ)
4. ì‹œì‘í™”/ëí™” ê°ì§€ ë° ì‹ ë¢°ë„ ê³„ì‚°
5. JSON ìºì‹± ë° DB ì €ì¥

## ğŸ› ï¸ ê¸°ìˆ ì  ê³„íš (Technical Plan)

### êµ¬í˜„ëœ ëª¨ë“ˆ

#### 1. `FileSampler` í´ë˜ìŠ¤
- `sample_file()`: íŒŒì¼ ì•ë’¤ 20KB ì¶”ì¶œ
- `_detect_encoding()`: chardet ì¸ì½”ë”© ê°ì§€ (ì‹ ë¢°ë„ 0.7 ì´ìƒ)
- UTF-8 fallback ì§€ì›

#### 2. `EpisodePatternDetector` í´ë˜ìŠ¤
- `detect_pattern()`: AI ê¸°ë°˜ í™”ìˆ˜ íŒ¨í„´ ê°ì§€
- `_build_pattern_prompt()`: Gemini í”„ë¡¬í”„íŠ¸ ìƒì„±
- `_parse_pattern_response()`: JSON ì‘ë‹µ íŒŒì‹±
- `save_to_db()`: episode_patterns í…Œì´ë¸” ì €ì¥
- JSON ìºì‹±: `data/cache/episode_pattern/{hash}.json`

### ê°ì§€ ì •ë³´
```json
{
  "pattern_regex": "ì œ(\\d+)í™”",
  "detected_start": 1,
  "detected_end": 340,
  "confidence": 0.95
}
```

### ì²˜ë¦¬ íë¦„
1. íŒŒì¼ ì•ë’¤ 20KB ìƒ˜í”Œë§
2. ì¸ì½”ë”© ìë™ ê°ì§€ (chardet)
3. Gemini APIë¡œ íŒ¨í„´ ë¶„ì„
4. ì •ê·œì‹, ì‹œì‘/ëí™”, ì‹ ë¢°ë„ ì¶”ì¶œ
5. DB ì €ì¥ (episode_patterns í…Œì´ë¸”)

## âœ… ì™„ë£Œ ì¡°ê±´ (Definition of Done)

- [x] FileSampler êµ¬í˜„ (ì•ë’¤ 20KB ì¶”ì¶œ, ì¸ì½”ë”© ê°ì§€)
- [x] EpisodePatternDetector êµ¬í˜„ (AI íŒ¨í„´ ê°ì§€)
- [x] ì •ê·œì‹ ì¶”ì¶œ ë° ì‹œì‘/ëí™” ê°ì§€
- [x] JSON ìºì‹± êµ¬í˜„
- [x] episode_patterns í…Œì´ë¸” ì €ì¥
- [x] í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±

## ğŸ“ ì§„í–‰ ê¸°ë¡

| ë‚ ì§œ | ë‚´ìš© |
|:---|:---|
| 2026-02-12 | ì´ìŠˆ ìƒì„± |
| 2026-02-12 | FileSampler + EpisodePatternDetector êµ¬í˜„ ì™„ë£Œ |
