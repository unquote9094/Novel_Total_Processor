## ğŸ“ ë°°ê²½ ì§€ì‹ (Context)

Phase A-2ëŠ” Novel Total Processorì˜ í•µì‹¬ ë°ì´í„° ê³„ì¸µì„ êµ¬ì¶•í•˜ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤. SQLite ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆì™€ YAML ì„¤ì • íŒŒì¼ ë¡œë”ë¥¼ êµ¬í˜„í•˜ì—¬, ì´í›„ ëª¨ë“  ë‹¨ê³„ì—ì„œ ì‚¬ìš©í•  ê¸°ë°˜ì„ ë§ˆë ¨í•©ë‹ˆë‹¤.

## ğŸ¯ ëª©í‘œ (Goal)

1. SQLite ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ êµ¬í˜„ (ì„¤ê³„ì„œ v2 ê¸°ì¤€ 7ê°œ í…Œì´ë¸”)
2. YAML ì„¤ì • ë¡œë” êµ¬í˜„ (`config.yml`, `rules.yml`)
3. íƒ€ì… ì•ˆì „ì„±ì„ ìœ„í•œ dataclass ê¸°ë°˜ ì„¤ì • ê°ì²´
4. Context manager ì§€ì› DB í´ë˜ìŠ¤
5. í†µí•© í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± ë° ê²€ì¦

## ğŸ› ï¸ ê¸°ìˆ ì  ê³„íš (Technical Plan)

### êµ¬í˜„ëœ ëª¨ë“ˆ

#### 1. `src/novel_total_processor/db/schema.py`
- **7ê°œ í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ**:
  - `files`: íŒŒì¼ ì¸ë±ì‹± (ê²½ë¡œ, í•´ì‹œ, ì¤‘ë³µ ê°ì§€)
  - `novels`: ì†Œì„¤ ë©”íƒ€ë°ì´í„° (ì œëª©, ì‘ê°€, ì¥ë¥´, íƒœê·¸, ë³„ì )
  - `novel_extra`: ë¶€ê°€ ì •ë³´ (ISBN, ì¶œíŒì‚¬, ì„¤ëª…)
  - `episode_patterns`: AI í™”ìˆ˜ ë¶„ì„ ê²°ê³¼
  - `rename_plan`: íŒŒì¼ëª… ë³€ê²½ ê³„íš (ê²€ìˆ˜ìš©)
  - `processing_state`: íŒŒì´í”„ë¼ì¸ ì²˜ë¦¬ ìƒíƒœ (Stage 0~5)
  - `batch_logs`: ë°°ì¹˜ ì‹¤í–‰ ë¡œê·¸
- **Database í´ë˜ìŠ¤**:
  - Context manager ì§€ì› (`with` ë¬¸)
  - `row_factory = sqlite3.Row` (dict-like ì ‘ê·¼)
  - `initialize_schema()`: í…Œì´ë¸” ìë™ ìƒì„±

#### 2. `src/novel_total_processor/config/loader.py`
- **dataclass ê¸°ë°˜ ì„¤ì • ê°ì²´**:
  - `Config`: ì „ì²´ ì„¤ì • (paths, api, processing, epub, logging, ui)
  - `FilenameRules`: íŒŒì¼ëª… ê·œì¹™ (title, episode, status, rating, genre, author, tags)
- **ì‹±ê¸€í†¤ íŒ¨í„´**: `get_config()`, `get_rules()`
- **YAML íŒŒì‹±**: `yaml.safe_load()`

#### 3. `test_db_config.py`
- ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ìƒì„± í…ŒìŠ¤íŠ¸
- ì„¤ì • íŒŒì¼ ë¡œë“œ í…ŒìŠ¤íŠ¸
- ê·œì¹™ íŒŒì¼ ë¡œë“œ í…ŒìŠ¤íŠ¸

### í…ŒìŠ¤íŠ¸ ê²°ê³¼
```
âœ… Created 7 tables: files, novels, novel_extra, episode_patterns, rename_plan, processing_state, batch_logs
âœ… Config loaded: 2 source folders
âœ… Rules loaded: 10 genre mappings
ğŸ‰ All tests passed!
```

## âœ… ì™„ë£Œ ì¡°ê±´ (Definition of Done)

- [x] SQLite ìŠ¤í‚¤ë§ˆ êµ¬í˜„ (7ê°œ í…Œì´ë¸”)
- [x] Database í´ë˜ìŠ¤ êµ¬í˜„ (context manager)
- [x] Config ë¡œë” êµ¬í˜„ (dataclass ê¸°ë°˜)
- [x] Rules ë¡œë” êµ¬í˜„
- [x] í†µí•© í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
- [x] í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì„±ê³µ

## ğŸ“ ì§„í–‰ ê¸°ë¡

| ë‚ ì§œ | ë‚´ìš© |
|:---|:---|
| 2026-02-12 | ì´ìŠˆ ìƒì„± |
| 2026-02-12 | DB ìŠ¤í‚¤ë§ˆ + Config ë¡œë” êµ¬í˜„ ì™„ë£Œ, í…ŒìŠ¤íŠ¸ í†µê³¼ |
