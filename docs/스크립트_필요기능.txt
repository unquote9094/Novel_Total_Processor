
소설 텍스트 파일이 많이 있어 
소설 epub 파일도있고 
모두 다해서 15000개 정도인데 매일 약200개씩 늘어날거야 

이것들이 파일명이 좀 엉망이야 

[아애담] 짐승들과 미로에 갇혔다 1-120完.epub
- 장르가 없음, 태그도 없음, 화수가 정확한지 확인해야함

대충 공법을 지어냈더니, 제자야, 정말 터득했느냐549~601(완).txt
- 작가명 없음, 장르, 태그도 없음, 화수가 실제로 549부터 있는건지 확인해야함

[게임소설] 스튁스 88.txt
- 작가명, 장르, 태그 없음, 완결인지 연재중인지 외전인지 확인해야함, 88화 단독인지? 1~88화까지 인지 불명확함


보통 이런식으로 파일명이 되어있고 소설의 정보가 없는게 문제야 
그래서 기능들이 필요해 

1. 파일명을 바탕으로 
소설을 검색해서 [작가명/장르/태그/완결.연재.외전등등의 상태정보/별-점수/표지 이미지] 등을 구해온다
이건 제미나이와 퍼플렉시티의 api를 써서 검색을 할거야
그외의 정보들은 .. 예를들어서 ISBN 이나 출판사, 출판일 등등의 도서 정보들은 있으면 따로 파일로 저장해두고 없어도 무방해 

2. 파일의 화수가 정확히 어떤것인지 파일을 앞부분과 끝부분을 여유있게 20kb 정도?? 열어보고 파악한다.

3. 1번과 2번의 정보를 정해진 규칙으로 파일명에 반영한다 
예 : [퓨판] 평행차원에서 온 능력자 - 완.txt    ==>  평행차원에서_온_능력자#본편:1~230:완결#외전:1~14:완결#광수#퓨전판타지#현대물.환생.성장물.타임슬립#★3#.txt
이건 적당한 예시를 든것이고 파일명의 규칙은 좀더 고민해서 결정해야 할듯해 
이것에 대해서는 완전하지 않지만 대략 7-80퍼센트 완성해둔 코드가 있어 
- 폴더의 파일들의 파일명을 싹 문서로 만들고
- 이걸 정해진 파일명 규칙대로 AI에게 보낸후 규칙대로 맞춰진 파일명을 받아서
- 또 다른 문서파일로 만들고 이걸 실제로 내가 수동으로 잘 되었는지 검사할거야
- 그후에 모든게 잘 변경 되었다고 판단하면 이 텍스트 파일의 내용대로 [ 원본파일명 ---- 규칙화된 파일명 ] 을 보고 실제 폴더의 파일명을 싹 다 변경해

E:\DEVz\10_Novel_Total_Processor\docs\reference\Novel_Title_Normalizer_v1.2.4_Release
이곳에 만들어둔 파워셀 스크립트가 있어


4. txt 파일을 epub으로 변환 하는기능이 필요한데 
그 이전에 전처리 과정을 거쳐야해 
800화나 2000화가 넘는 소설들이 텍스트 파일 한개의 통짜 파일이야
이걸 AI에 보내서 각화의 패턴을 찾아내고 패턴결과를 받으면 
거기에 맞춰서 구분자 같은걸 넣어서 각 화를 확실하게 나눌수 있도록 내용을 수정해야해 
이건 예전에 만들어놓은 코드가 있으니 바로 가져다 쓰면 되
E:\DEVz\10_Novel_Total_Processor\docs\reference\NovelAIze-SSR_Source_v3.0 
이곳에 만들어놓은 스크립트 앱이 있어 

1번부터 4번까지 과정이 끝나면 
표지 이미지와 각종 정보를 담은 파일명과 각 화가 잘 구분된 덱스트 파일이 하나 만들어질거야 

5. 이 텍스트 파일을 epub 파일로 변환 하는거야 
각종 메타데이터의 정보는 파일명과 표지 이미지를 사용하고 
각화는 이미 구분자로 구분되어 있고 하니 만드는건 문제없을거야 
그리고 깃헙에서 txt-epub 변환 코드들을  3가지 구해왔으니 이걸 잘 분석해서 
어떤걸 사용하고 기능을 적당히 빼고 넣을지 정해서 만들면 되는거야 

E:\DEVz\10_Novel_Total_Processor\docs\reference\ez-books-1.0.1
E:\DEVz\10_Novel_Total_Processor\docs\reference\txt-to-epub-converter-main
E:\DEVz\10_Novel_Total_Processor\docs\reference\txt2pub
이곳에 예제로 사용할 변환 코드들이 있어

6. 이제 모든 기능들이 다 완성이 되면 
15000개 이상의 소설파일들을 일괄 배치 처리 하는 기능으로 완성을 하고 
rich ui를 사용해서 자세한 상황을 알려주도록 ui를 만들어 
배치 처리는 .. 각 단계, 즉 1번~6번 까지를 한개 소설씩 만드는게 아니라
수량이 매우 많으므로 
1번에서 1천개나 아니면 모두 15000개 일괄 처리 
2번에서도 한꺼번에 모든 파일을 다 처리
..
..
6번에서도 한꺼번에 15000개 이상을 처리함

이런식으로 하게 될거야 

지금 15000개의 소설 파일이 30개의 폴더에 나누어져 저장되어 있어 
이중에서 완전 같은 파일이 있을수도 있고 
같은 소설인데 연재중이라서 소설1-340화 , 소설1-345화 .. 이런식으로 있기도해
그리도 이런 배치작업이 모두 끝나면 
한개의 폴더로 모두 합칠것이야

그리고 매일 200개씩 소설을 새로 다운받아 
이 200개를 이 스크립트로 모두 처리하고 나온 epu결과물을 
소설이 모두 모여있는 폴더로 합치는거야 
이걸 매일 반복 할거야 

이것들도 계획에 반영해야 해 

이제 이걸 어떻게 구현을 할지 
제안을 해봐 가장 좋은 방법으로 해야지 
어떤 언어를 사용하는게 좋을지 ?? 
어떤 방법으로 만드는게 좋을지 ??  등등 
다양한 제안과 의견을 깊게 생각해서 알려줘 

======================================================


그래 좋긴한데 잘 들어봐 

[MODIFY] 
config.yml
source_folders를 Test_Novels로 변경
또는 첫 실행 시 사용자에게 폴더 경로 입력 받는 로직 추가
-- 당연히 폴더 경로 입력을 받아야지 
명령행으로 받는게 아니라 .. 폴더 선택으로 해야해 
-------------------
[MODIFY] 
menu.py
현재 문제: 숫자만 입력하면 DB 순서대로 아무거나 처리

개선안: 각 Stage 실행 전 파일 목록을 보여주고 선택 가능

│  2   │ 나 혼자만 레벨업.txt                  │ 45.7 MB  │ 메타완료  │
이것도 메타완료 뿐 아니라 ..메타정보도 보여줘야지 
어떤 정보들을 수집했나 내용을 다 보여주지는 않더라도 
작가/ 장르/ 표지/ 태그 / 완결여부 / 화수 등등 각 항목의 수집여부를 알게는 해야지 

디비보는 기능은 따로 8번 으로 구현하는 계획이 있구먼 .. 이건 아주 좋아 

챕터 분할 도 
2000화 짜리 구분하는거는 NovelAIze-SSR v3.0에서 다 구현 한거야 
다른 여러 소설로 테스트 해봤으니까 NovelAIze-SSR v3.0 의 코드를 거의 그대로
포팅을 하면되는거야 ..
자꾸 정규식을 먼저 사용하려고 하는데 .. 하지 말랬자나 
그냥 NovelAIze-SSR v3.0 대로 하라고!!
ai에게 30개든 50개던 균등하게 30개를 뽑아서 ai에게 보내고 
패턴 정규식을 결과값으로 받아서 
그걸로 정규식을 사용해서 구분자를 넣고 구분하는거자나
NovelAIze-SSR v3.0가 이렇게 구현되어 있는데 .. 뭐가 힘들어! 
있는 기능 그대로 포팅을 하라고 .. 다른 기능이나 다른방법으로 가지말고!!!
더 좋은 방법이 있을때만 제안을 먼저하고 설명을 하고 승인을 받아야지!!!

자 잘들어봐 
에휴 .. 지금 이 앱의 목적이 엉망으로 파일명이 되어 있고 
300화든지 2000화던지 통짜로 되어있는걸 
소설을 정보를 검색해서 저장해두고 
실제 파일의 내용을 확인해서 화수의 정확한 정보를 알아내서 구분 하고 
이걸 바탕으로 
소설 정보 + 표지 이미지 + 구분된 텍스트파일 = epub 만들기 
이게 목적이자나!!!!
이걸 일괄적으로 자동화해서 1만개 2만개 를 처리해야 하는거고 
매일 2-300개씩 해야 한다니깐!!!


그러니까 
  [1] 📁 파일 인덱싱 (File Indexing) - Stage 0
  [2] 📚 메타데이터 수집 (Metadata Collection) - Stage 1
  [3] 🔢 화수 검증 (Episode Verification) - Stage 2
  [4] 📝 파일명 생성 (Filename Generation) - Stage 3
  [5] 📖 EPUB 생성 (EPUB Generation) - Stage 5
지금 이거는 순서가 잘못된거야 !!


스테이지를 기준으로 설명 해줄게 
메뉴 번호가 아니라 스테이지 번호가 기준이야 !!

스테이지0) 폴더의 파일들을 인덱싱 하고, 중복 파일은 사용자에게 알려주고 따로 저장도 해두고!
스테이지1) 소설 제목을 바탕으로 소설정보를 검색해서 정보를 모아서 저장하고
스테이지4) 스테이지 4의 챕터 분할을 ai에게 패턴 분석을 맡겨서 나온 정규식을 
사용해서 각 화를 다 구분을 해서 알아낸 화수가 있자나  

추가적으로 각 챕터 제목을 알아내다 보면 
본편 이 완결되고 외전이나 후기 , 후일담, 에필로그 , 작가의 말  등등
본편 이후의 내용들도 알아낼수 있자나!!
이건 NovelAIze-SSR v3.0 에서는 없는 기능이니까 
ai애게 패턴 정규식을 받아서 구분자를 전체 넣을때 
각 챕터의 제목을 인식해서 본편 이 몇화 , 외전 몇화, 에필로그, 후일담 몇화  등등 
챕터 제목을 싹 조사하면 다 알아 낼수 있는거자나!!

그래서 지금 현재의 
[3] 🔢 화수 검증 (Episode Verification) - Stage 2 
스페이지2  이것도 스테이지4-챕터 분할 이후로 하면 바로 해결 된거지!!!

이제 스테이지  0번 1번 4번 2번 3번 으로 순서가 맞는것이고  
일단 0-1-4-2 순서로 다 하고 난후에 가지고 있는 정보가 
소설 의 각종 정보, 표지 , 실제파일의 내용과 화수 파악된것 
이렇게 있으니 파일명은 아주 간단히 파일명 규칙대로 
만들수 있는거지!!  
그러니까 5번째 작업은 스테이지3이 맞는거야!!

그러면 이제 다 전처리가 끝난거자나!!
스테이지0 - 파일들 인덱싱 완료, 중복파일 출력 및 저장!
스테이지1 - 소설정보 모아서 저장완료
스테이지4 - ai를 통해서 실제파일의 화수 구분 완료 
+ 각 챕터 제목들 인식해서 저장을 한후 보유하고 있는 파일의 본편 외전 등등 
화수과 내용 파악 완료! ( 따로 스테이지를 안만든 이유는 ai 패턴 정규식으로 
구분자를 넣으면서 챕터 제목을 수집하면 되기 때문이지!! )

스테이지2 - 챕터 제목 저장해둔것을 사용해서 화수도  검증 완료!!
스테이지3 - 소설 정보 모은것과 실재파일 내용 파악한것으로 파일명도 변경 완료!!
스테이지5 - txt 파일을 epub 으로 변경 ! 메타정보 업데이트+표지 삽입+목차 생성 필수!!!

여기서 문제는 txt 파일은 이 순서대로 하면 되는데 
처음부터 epub 파일을 처리 하는걸 제대로 구현 했는지가 관건이야!!

이미 원본epub 파일은 
- 파일명과 소설제목을 바탕으로 소설정보 수집
- 챕터 구분은 할 필요 없을거야 epub 파일은 이미 화마다 다 따로 각각 xhtml로 
만들어져 있을테니까 .. 그래서 바로 화수 검증을 할수 있는거고 목차가 있는지 확인하고!!
- 검색해서 모은 소설 정보를 사용해서 파일명 변경하고 
- epub 제작 스테이지에서 메타데이터 와 표지를 넣으면 끝이지 

이 모든 과정이 끝난후에 
제대로 만들어졌는지 검증은 반드시 해야해!!!
검증을 대충 하지 말고 아주 꼼꼼하게 하는 코드가 있어야해 !!



















